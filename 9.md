import os
import pandas as pd
import time
from datetime import datetime
import argparse
import logging
import tracemalloc
from src.db_operation.ne4j_operations import IAM_GraphOperations
from sc.utils.helper import read_creds, initialize_main_logger, get_config_stream
from neodi import GraphDatabase, exceptions

# Set up paths
currentdir = os.path.dirname(os.path.realpath(__file__))
parentdir = os.path.dirname(currentdir)
sys.path.append(parentdir)

# Entrypoint for Script to run
# cd pipeline_routines/supervisor_hierarchy & sh populate_supervisor_hierarchy.sh.

if __name__ == "__main__":
    tracemalloc.start()

    parser = argparse.ArgumentParser(description="Populate supervisor hierarchy")
    parser.add_argument(
        "--load_type", "-L", type=str, help="Specify the load_type: full/delta"
    )
    parser.add_argument("--log_location", type=str, help="Specify the log location")
    args = parser.parse_args()

    # Initializing variables
    load_type = args.load_type.lower()
    configuration_file = "/config/config.yaml
