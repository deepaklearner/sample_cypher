Great question ‚Äî **no**, the provided code does **not** open a new connection for every batch.

Here‚Äôs how it works:

* The connection is established **once** at the start via `self.connect()`.
* It remains open while batches are fetched using the same cursor.
* If a **query fails** (e.g., due to a connection timeout or dropped connection), the `except` block will:

  * Retry up to `max_retries`
  * Call `self.connect()` again ‚Äî which will re-establish the connection (and recreate the cursor)
  * Resume from the same batch using the `offset`

---

### ‚úÖ So, in normal execution:

* **One connection** is used throughout all batches.

### üîÅ If a failure happens mid-way:

* It reconnects and continues from where it left off.

This is a **resilient and efficient** approach ‚Äî it avoids unnecessary reconnections but can recover gracefully from dropped connections.

Would you like to modify this to also **log progress to a file or checkpoint**, so it can resume even after a crash?
