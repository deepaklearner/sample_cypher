To measure the performance or time taken by your functions, you can use Python's built-in `time` module or more advanced tools like `timeit` or `cProfile`. For your current script, the simplest way is to use the `time` module.

Here‚Äôs how you can modify your script to measure how long it takes to run the `apply(analyze_entitlement_owners)` logic:

### ‚úÖ **Add timing with `time` module:**

```python
import pandas as pd
import time

# Sample data
entitlements_owners_in_graph = pd.DataFrame({
    'entitlementName': ['Ent1', 'Ent2'],
    'targetSystem': ['SysA', 'SysB'],
    'owners': [['A1010', 'A1818'], ['B2020', 'B3030']],
    'owners_status': [
        [['A1010', 'Active'], ['A1818', 'Inactive']],
        [['B2020', 'Active'], ['B3030', 'Active']]
    ]
})

entitlements_owners_in_edw = pd.DataFrame({
    'entitlementName': ['Ent1', 'Ent2'],
    'targetSystem': ['SysA', 'SysB'],
    'owner1': ['A1010', 'B2020'],
    'owner2': ['A1919', None],
    'owner3': [None, None]
})

# Helper function
def extract_edw_owners(row):
    return set(filter(pd.notna, [row.get('owner1'), row.get('owner2'), row.get('owner3')]))

# Merge
merged_df = pd.merge(
    entitlements_owners_in_edw,
    entitlements_owners_in_graph,
    on=['entitlementName', 'targetSystem'],
    how='left'
)

# Function to analyze rows
def analyze_entitlement_owners(row):
    edw_owners = extract_edw_owners(row)
    graph_owners = set(row['owners']) if isinstance(row['owners'], list) else set()
    delta = edw_owners != graph_owners
    missing_in_graph = list(edw_owners - graph_owners)
    active_owners = []
    if isinstance(row['owners_status'], list):
        active_owners = [emp for emp, status in row['owners_status'] if str(status).lower() == 'active']
    return pd.Series({
        'delta_entitlement_owners': delta,
        'missing_owners_in_graph': missing_in_graph,
        'active_owners': active_owners
    })

# ‚è± Time the apply logic
start_time = time.time()
results = merged_df.apply(analyze_entitlement_owners, axis=1)
end_time = time.time()

print(f"\nTime taken to analyze entitlement owners: {end_time - start_time:.6f} seconds\n")

# Combine results
final_df = pd.concat([merged_df, results], axis=1)

# Select relevant columns
final_result = final_df[[
    'entitlementName', 'targetSystem',
    'delta_entitlement_owners', 'missing_owners_in_graph', 'active_owners'
]]

print(final_result)
```

### üß† Output:

This will show the time taken like:

```
Time taken to analyze entitlement owners: 0.001234 seconds
```

Let me know if you'd like to measure performance for specific sub-steps or use profiling tools like `cProfile` or `line_profiler` for deeper analysis.


GESS reviewer

