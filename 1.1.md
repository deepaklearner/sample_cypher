To debug a `Permission denied` error for the file `date_time.yaml` in a Unix script that calls a Python script, follow these steps methodically:

---
 
### ✅ 1. **Check File Permissions**

Run this to check the file's permissions and ownership:

```bash
ls -l date_time.yaml
```

Look for:

* File permissions: e.g., `-rw-r--r--`
* Owner and group: e.g., `user user`

---

### ✅ 2. **Check the User Running the Script**

Determine who is executing the Unix script:

```bash
whoami
```

Ensure that this user has permission to read/write `date_time.yaml`.

If it's being run via `cron`, `systemd`, or another service, it may run under a different user (e.g., `root`, `www-data`, etc.).

---

### ✅ 3. **Check Directory Permissions**

The file's directory must be writable if you're modifying or creating the file.

```bash
ls -ld $(dirname date_time.yaml)
```

Make sure:

* You have **write** permission on the directory.
* The directory is not mounted with restricted permissions (e.g., `noexec`, `readonly`).

---

### ✅ 4. **Check for File Locking or Process Holding the File**

Use `lsof` to see if another process is using the file:

```bash
lsof date_time.yaml
```

---

### ✅ 5. **Temporarily Add Debug Statements**

Add debug output in your shell and Python scripts:

#### In your shell script:

```bash
set -x  # Enables tracing
echo "User: $(whoami)"
echo "File permissions:"
ls -l date_time.yaml
```

#### In your Python script:

Add something like:

```python
import os
import stat

file_path = "date_time.yaml"
print("User:", os.getlogin())
print("File exists:", os.path.exists(file_path))
if os.path.exists(file_path):
    st = os.stat(file_path)
    print("Permissions:", oct(st.st_mode)[-3:])
    print("Owner UID:", st.st_uid)
    print("Writable by current user:", os.access(file_path, os.W_OK))
```

---

### ✅ 6. **Check SELinux or AppArmor (if applicable)**

If using SELinux or AppArmor, those can block access regardless of Unix file permissions.

Check logs:

```bash
dmesg | grep denied
```

Or for SELinux:

```bash
ausearch -m avc -ts recent
```

---

### ✅ 7. **Check How the File is Being Used in Python**

Ensure you're opening the file in a correct mode and path. E.g.,

```python
with open("date_time.yaml", "w") as f:
    ...
```

If the file path is relative, confirm that the working directory of the shell script matches expectations (`pwd` inside the script).

---

### ✅ 8. **Try Manually Running the Python Script**

From the command line, try:

```bash
python your_script.py
```

If that works but the shell script doesn’t, the problem is likely:

* User mismatch
* Path mismatch
* Environment variables
* Different working directory

---

### Need Help Reading Specific Logs or Code?

If you can share the relevant part of your shell and Python scripts (especially where the file is accessed), I can help you pinpoint the issue more precisely.
