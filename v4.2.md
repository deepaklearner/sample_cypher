v1.1 solution

MATCH (u:User)
WHERE u.managerid IS NOT NULL

// Traverse the reporting structure (up to 4 levels)
OPTIONAL MATCH (n)-[:REPORTS_TO*1..4]->(m:User)
OPTIONAL MATCH (m)-[:HAS_ATTRIBUTE]->(n:Name)

WITH u, collect(distinct m) as managers, collect(distinct n) as names

RETURN 
    u.employeeNumber AS employeeNumber, managers[0].employeeNumber AS managerid, 
       CASE 
        WHEN size(managers) = 1 AND u.employeeNumber = managers[0].employeeNumber THEN 1  
        WHEN size(managers) = 1 AND u.employeeNumber <> managers[0].employeeNumber THEN 2   
        WHEN size(managers) = 2 THEN 3   
        WHEN size(managers) = 3 THEN 4   
        ELSE 5                           
     END AS Level,
        CASE WHEN size(managers) > 0 THEN managers[0].employeeNumber ELSE NULL END AS L1managerid,
        CASE WHEN size(managers) > 0 THEN names[0].givenName ELSE NULL END AS L1managerFirstName,
        CASE WHEN size(managers) > 0 THEN names[0].familyName ELSE NULL END AS L1managerLastName,

       CASE WHEN size(managers) > 1 THEN managers[1].employeeNumber ELSE NULL END AS L2managerid,
        CASE WHEN size(managers) > 0 THEN names[1].givenName ELSE NULL END AS L2managerFirstName,
        CASE WHEN size(managers) > 0 THEN names[1].familyName ELSE NULL END AS L2managerLastName,

       CASE WHEN size(managers) > 2 THEN managers[2].employeeNumber ELSE NULL END AS L3managerid,
        CASE WHEN size(managers) > 0 THEN names[2].givenName ELSE NULL END AS L3managerFirstName,
        CASE WHEN size(managers) > 0 THEN names[2].employeeNfamilyNameumber ELSE NULL END AS L3managerLastName,

       CASE WHEN size(managers) > 4 THEN managers[3].employeeNumber ELSE NULL END AS L4managerid,
        CASE WHEN size(managers) > 0 THEN names[3].givenName ELSE NULL END AS L4managerFirstName,
        CASE WHEN size(managers) > 0 THEN names[3].familyName ELSE NULL END AS L4managerLastName
ORDER BY n.employeeNumber

