import pandas as pd
import pymysql

# Connect to the MySQL database using pymysql.connect
conn = pymysql.connect(
    host='localhost',
    user='username',
    password='password',
    database='yourdb'
)

cursor = conn.cursor()

# Assuming your dataframe is 'df'
batch_size = 1000

# 1. Truncate the table before inserting new data
cursor.execute("TRUNCATE TABLE your_table;")
conn.commit()  # Commit the truncate operation

# 2. Insert data in batches
for start in range(0, len(df), batch_size):
    end = start + batch_size
    batch = df.iloc[start:end]
    
    # Prepare the insert query
    insert_query = "INSERT INTO your_table (column1, column2, column3, ...) VALUES (%s, %s, %s, ...)"
    
    # Convert the batch into a list of tuples
    data_to_insert = [tuple(row) for row in batch.values]
    
    # Execute the insert query for the batch
    cursor.executemany(insert_query, data_to_insert)
    conn.commit()  # Commit the insert operation for this batch

# Close the cursor and connection
cursor.close()
conn.close()
